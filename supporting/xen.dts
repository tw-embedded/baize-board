/dts-v1/;

/ {
	interrupt-parent = <0x8001>;
	#size-cells = <0x2>;
	#address-cells = <0x2>;
	compatible = "linux,dummy-virt";

	virtio_mmio@20002000 {
		dma-coherent;
		interrupts = <0x0 0x12 0x1>; /* GIC_SPI 0x12 IRQ_TYPE_EDGE_RISING */
		reg = <0x0 0x20002000 0x0 0x200>;
		compatible = "virtio,mmio";
	};

	virtio_mmio@20002200 {
		dma-coherent;
		interrupts = <0x0 0x13 0x1>;
		reg = <0x0 0x20002200 0x0 0x200>;
		compatible = "virtio,mmio";
	};

	virtio_mmio@20002400 {
		dma-coherent;
		interrupts = <0x0 0x14 0x1>;
		reg = <0x0 0x20002400 0x0 0x200>;
		compatible = "virtio,mmio";
	};

	virtio_mmio@20002600 {
		dma-coherent;
		interrupts = <0x0 0x15 0x1>;
		reg = <0x0 0x20002600 0x0 0x200>;
		compatible = "virtio,mmio";
	};

	virtio_mmio@20002800 {
		dma-coherent;
		interrupts = <0x0 0x16 0x1>;
		reg = <0x0 0x20002800 0x0 0x200>;
		compatible = "virtio,mmio";
	};

	virtio_mmio@20002a00 {
		dma-coherent;
		interrupts = <0x0 0x17 0x1>;
		reg = <0x0 0x20002a00 0x0 0x200>;
		compatible = "virtio,mmio";
	};

	virtio_mmio@20002c00 {
		dma-coherent;
		interrupts = <0x0 0x18 0x1>;
		reg = <0x0 0x20002c00 0x0 0x200>;
		compatible = "virtio,mmio";
	};

	virtio_mmio@20002e00 {
		dma-coherent;
		interrupts = <0x0 0x19 0x1>;
		reg = <0x0 0x20002e00 0x0 0x200>;
		compatible = "virtio,mmio";
		xen,passthrough;
		status = "okay";
	};

/* rtc will be probed by edk2 service, efi rtc
	pl031@20003000 {
		clock-names = "apb_pclk";
		clocks = <0x8000>;
		interrupts = <0x0 0x1a 0x4>;
		reg = <0x0 20003000 0x0 0x1000>;
		compatible = "arm,pl031", "arm,primecell";
	};
*/

/*
	pl061@9030000 {
		phandle = <0x8003>;
		clock-names = "apb_pclk";
		clocks = <0x8000>;
		interrupts = <0x0 0x7 0x4>;
		gpio-controller;
		#gpio-cells = <0x2>;
		compatible = "arm,pl061", "arm,primecell";
		reg = <0x0 0x9030000 0x0 0x1000>;
	};

	pcie@10000000 {
		interrupt-map-mask = <0x1800 0x0 0x0 0x7>;
		interrupt-map = <0x0 0x0 0x0 0x1 0x8001 0x0 0x0 0x0 0x3 0x4 0x0 0x0 0x0 0x2 0x8001 0x0 0x0 0x0 0x4 0x4 0x0 0x0 0x0 0x3 0x8001 0x0 0x0 0x0 0x5 0x4 0x0 0x0 0x0 0x4 0x8001 0x0 0x0 0x0 0x6 0x4 0x800 0x0 0x0 0x1 0x8001 0x0 0x0 0x0 0x4 0x4 0x800 0x0 0x0 0x2 0x8001 0x0 0x0 0x0 0x5 0x4 0x800 0x0 0x0 0x3 0x8001 0x0 0x0 0x0 0x6 0x4 0x800 0x0 0x0 0x4 0x8001 0x0 0x0 0x0 0x3 0x4 0x1000 0x0 0x0 0x1 0x8001 0x0 0x0 0x0 0x5 0x4 0x1000 0x0 0x0 0x2 0x8001 0x0 0x0 0x0 0x6 0x4 0x1000 0x0 0x0 0x3 0x8001 0x0 0x0 0x0 0x3 0x4 0x1000 0x0 0x0 0x4 0x8001 0x0 0x0 0x0 0x4 0x4 0x1800 0x0 0x0 0x1 0x8001 0x0 0x0 0x0 0x6 0x4 0x1800 0x0 0x0 0x2 0x8001 0x0 0x0 0x0 0x3 0x4 0x1800 0x0 0x0 0x3 0x8001 0x0 0x0 0x0 0x4 0x4 0x1800 0x0 0x0 0x4 0x8001 0x0 0x0 0x0 0x5 0x4>;
		#interrupt-cells = <0x1>;
		ranges = <0x1000000 0x0 0x0 0x0 0x3eff0000 0x0 0x10000 0x2000000 0x0 0x10000000 0x0 0x10000000 0x0 0x2eff0000 0x3000000 0x80 0x0 0x80 0x0 0x80 0x0>;
		reg = <0x40 0x10000000 0x0 0x10000000>;
		msi-parent = <0x8002>;
		dma-coherent;
		bus-range = <0x0 0xff>;
		linux,pci-domain = <0x0>;
		#size-cells = <0x2>;
		#address-cells = <0x3>;
		device_type = "pci";
		compatible = "pci-host-ecam-generic";
	};
*/

	pl011@20000000 {
		clock-names = "uartclk", "apb_pclk";
		clocks = <0x8000 0x8000>;
		interrupts = <0x0 0x10 0x4>;
		reg = <0x0 0x20000000 0x0 0x1000>;
		compatible = "arm,pl011", "arm,primecell";
	};

	flash@4000000 {
		bank-width = <0x4>;
		reg = <0x0 0x04000000 0x0 0x01000000>;
		compatible = "cfi-flash";
	};

	memory@30000000 {
		reg = <0x0 0x30000000 0x0 0x40000000>;
		device_type = "memory";
	};

	psci {
		migrate = <0xc4000005>; /* PSCI_MIGRATE_AARCH64 */
		cpu_on = <0xc4000003>; /* PSCI_CPU_ON_AARCH64 */
		cpu_off = <0x84000002>; /* PSCI_CPU_OFF */
		cpu_suspend = <0xc4000001>; /* PSCI_CPU_SUSPEND_AARCH64 */
		method = "smc";
		compatible = "arm,psci-0.2", "arm,psci";
	};

	cpus {
		#size-cells = <0x0>;
		#address-cells = <0x1>;

		cpu0: cpu@0 {
			reg = <0x0>;
			enable-method = "psci";
			compatible = "arm,cortex-a57";
			device_type = "cpu";
		};

		cpu1: cpu@1 {
			reg = <0x1>;
			enable-method = "psci";
			compatible = "arm,cortex-a57";
			device_type = "cpu";
		};

		cpu2: cpu@2 {
			reg = <0x2>;
			enable-method = "psci";
			compatible = "arm,cortex-a57";
			device_type = "cpu";
		};

		cpu3: cpu@3 {
			reg = <0x3>;
			enable-method = "psci";
			compatible = "arm,cortex-a57";
			device_type = "cpu";
		};

		cpu4: cpu@100 {
			reg = <0x100>;
			enable-method = "psci";
			compatible = "arm,cortex-a57";
			device_type = "cpu";
		};

		cpu5: cpu@101 {
			reg = <0x101>;
			enable-method = "psci";
			compatible = "arm,cortex-a57";
			device_type = "cpu";
		};

		cpu6: cpu@102 {
			reg = <0x102>;
			enable-method = "psci";
			compatible = "arm,cortex-a57";
			device_type = "cpu";
		};

		cpu7: cpu@103 {
			reg = <0x103>;
			enable-method = "psci";
			compatible = "arm,cortex-a57";
			device_type = "cpu";
		};
	};

	intc@10010000 {
			phandle = <0x8001>;
			interrupts = <0x1 0x9 0x4>; /* GIC_PPI ARCH_GIC_MAINT_IRQ IRQ_TYPE_LEVEL_HIGH */
			reg = <0x0 0x10010000 0x0 0x10000 0x0 0x10020000 0x0 0x04000000>;
			#redistributor-regions = <0x1>;
			compatible = "arm,gic-v3";
			ranges;
			#size-cells = <0x2>;
			#address-cells = <0x2>;
			interrupt-controller;
			#interrupt-cells = <0x3>;
	};

	timer {
		interrupts = <0x1 0xa 0x304 0x1 0xb 0x304 0x1 0xc 0x304 0x1 0xd 0x304>;
		always-on;
		compatible = "arm,armv8-timer", "arm,armv7-timer";
	};

	pmu {
		interrupts = <0x1 0x7 0x304>; /* VIRTUAL_PMU_IRQ */
		compatible = "arm,armv8-pmuv3";
	};

	apb-pclk {
		phandle = <0x8000>;
		clock-output-names = "clk24mhz";
		clock-frequency = <0x16e3600>;
		#clock-cells = <0x0>;
		compatible = "fixed-clock";
	};

	chosen {
		stdout-path = "/pl011@20000000";
		/* xen */
		xen,xen-bootargs = "console=ttyAMA0 noreboot loglvl=all dom0_max_vcpus=2 dom0_vcpus_pin dom0_mem=512M";
		#address-cells = <2>;
		#size-cells = <2>;

		/* begin of dom0-dtb */
		domain-cpupool = <&cp_dom0>;

		cp_dom0: cpupool0 {
			compatible = "xen,cpupool";
			cpupool-cpus = <&cpu0 &cpu1 &cpu3 &cpu4 &cpu5 &cpu6 &cpu7>;
			cpupool-sched = "null";
		};

		cp_threadx: cpupool1 {
			compatible = "xen,cpupool";
			cpupool-cpus = <&cpu2>;
			cpupool-sched = "null";
		};

		module@0 {
			/* compatible = "xen,linux-zimage","xen,multiboot-module"; */
			/* reg = <0x30000000 0xfe0000>; */
			compatible = "multiboot,kernel", "multiboot,module";
			xen,uefi-binary = "Image";
			bootargs = "root=/dev/vda2 rw rootfstype=ext4 rootwait earlycon console=ttyAMA0 init=/init ignore_loglevel";
		};

		module@3 {
			compatible = "multiboot,device-tree", "multiboot,module";
			xen,uefi-binary = "baize.dtb";
		};
		/* end of dom0-dtb */

		domus {
			compatible = "xen,domain";
			#address-cells = <2>;
			#size-cells = <2>;
			cpus = <1>;
			memory = <0 0x10000>;
			vpl011;
			domain-cpupool = <&cp_threadx>;

			module@1 {
				compatible = "multiboot,kernel", "multiboot,module";
				/* reg = <0x127a93000 0x1000000>; */
				xen,uefi-binary = "threadxen";
				bootargs = "console=ttyAMA0";
			};
		};
	};
};

