target remote:1234
set architecture aarch64
set disassemble-next-line on

# atf
add-symbol-file ./arm-trusted-firmware/build/fake/debug/bl1/bl1.elf
add-symbol-file ./arm-trusted-firmware/build/fake/debug/bl2/bl2.elf
add-symbol-file ./arm-trusted-firmware/build/fake/debug/bl31/bl31.elf
b bl1_entrypoint
b bl2_entrypoint
b bl31_entrypoint

b bl31_main
#b el3_exit

# uefi entry
b *0x50000000

# clear bp
d breakpoints

# uefi
add-symbol-file ./edk2/Build/Fake-AARCH64/DEBUG_GCC5/AARCH64/ArmVirtPrePiUniCoreRelocatable.debug 0x50009240
b _ModuleEntryPoint
b CEntryPoint
b PrePiMain
b DecompressFirstFv
b LoadDxeCoreFromFfsFile

# uefi.dxe
add-symbol-file ./edk2/Build/Fake-AARCH64/DEBUG_GCC5/AARCH64/DxeCore.debug 0x6f27a000+0x1000 -s .data 0x6f27a000+0x29000
b _ModuleEntryPoint
b DxeMain
b CoreInitializeMemoryServices
b InitMmu
b ArmVirtGetMemoryMap

d breakpoints

# uefi.pl011
b FdtPL011SerialPortLibInitialize
b PL011UartInitializePort

d breakpoints

# uefi.dxe.protocol
b CoreAllEfiServicesAvailable
b ProcessLibraryConstructorList
b InterruptDxeInitialize
add-symbol-file /home/alix/soc/edk2/Build/Fake-AARCH64/DEBUG_GCC5/AARCH64/MdeModulePkg/Universal/ResetSystemRuntimeDxe/ResetSystemRuntimeDxe/DEBUG/ResetSystemRuntimeDxe.dll 0x68AB0000
b ArmPsciResetSystemLibConstructor

c
